&lt;?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>crypto on Fellipe Gomes - Data Science Blog</title>
    <link>https://gomesfellipe.github.io/tags/crypto/</link>
    <description>√öltimos posts sobre Data Science, Machine Learning e R</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>pt-br</language>
    <managingEditor>gomes.fellipe1@gmail.com (Fellipe Carvalho Gomes)</managingEditor>
    <webMaster>gomes.fellipe1@gmail.com (Fellipe Carvalho Gomes)</webMaster>
    <lastBuildDate>Sun, 04 May 2025 00:00:00 +0000</lastBuildDate>
    <atom:link href="https://gomesfellipe.github.io/tags/crypto/" rel="self" type="application/rss+xml" />
    <item>
      <title>Construindo uma Equipe Multiagente de IA para An√°lise do Mercado Bitcoin</title>
      <link>https://gomesfellipe.github.io/post/2025-05-04-bitcoin-agent/</link>
      <pubDate>Sun, 04 May 2025 00:00:00 +0000</pubDate>
      <author>gomes.fellipe1@gmail.com (Fellipe Carvalho Gomes)</author>
      <guid>https://gomesfellipe.github.io/post/2025-05-04-bitcoin-agent/</guid>
      <description>Neste post, exploramos a cria√ß√£o de uma equipe de agentes de IA usando Python, LangChain, LangGraph e LangSmith para automatizar e monitorar a an√°lise do mercado de Bitcoin, desde a coleta de dados at√© a gera√ß√£o de relat√≥rios automatizados.</description>
      <content:encoded>&lt;![CDATA[
        


<!-- Neste post, vamos mergulhar na cria√ß√£o de uma equipe de agentes de Intelig√™ncia Artificial (IA) que trabalham juntos para coletar dados, analisar tend√™ncias e decidir se √© hora de alertar sobre oportunidades de investimento no Bitcoin. Utilizaremos Python, o framework LangChain e sua extens√£o LangGraph para orquestrar esses agentes, al√©m de t√©cnicas de Prompt Engineering para garantir que cada "membro" da equipe execute sua fun√ß√£o com precis√£o.  -->
<!-- Voc√™ j√° se perguntou como acompanhar o vol√°til mercado de Bitcoin sem passar horas analisando gr√°ficos e indicadores complexos?  -->
<!-- Prepare-se para descobrir como a IA generativa pode se tornar sua aliada na an√°lise de criptomoedas! -->
<div id="por-que-analisar-o-mercado-bitcoin-com-agentes-de-ia" class="section level2">
<h2>Por que Analisar o Mercado Bitcoin com Agentes de IA?</h2>
<p>O cen√°rio do bitcoin sempre foi meio intrigante. Foi lan√ßado h√° 16 anos mas at√© hoje ningu√©m sabe ao certo quem est√° por tr√°s do projeto ‚Äî o criador, conhecido apenas pelo pseud√¥nimo Satoshi Nakamoto, <strong>nunca revelou sua identidade</strong>. Al√©m disso o bitcoin foi a <a href="https://www.mgcholding.com.br/blog/blockchain-bitcoin-e-ativos-virtuais-entenda-a-relacao/#:~:text=O%20blockchain%2C%20em%20sua%20ess%C3%AAncia,conhecida%20aplica%C3%A7%C3%A3o%20da%20tecnologia%20blockchain.">primeira e ainda √© a mais conhecida aplica√ß√£o da tecnologia <strong>Blockchain</strong></a>, que revolucionou a forma como lidamos com registros digitais e seguran√ßa dos dados. Sua <strong>natureza descentralizada</strong> e sua not√≥ria <strong>volatilidade</strong> o tornam um ativo √∫nico.</p>
<p>Quem n√£o se lembra da hist√≥ria das <a href="https://www.binance.com/pt-BR/square/post/17395016879858">pizzas compradas por 10.000 BTC</a>, que hoje valeriam uma fortuna? Mesmo que varia√ß√µes dessa magnitude sejam improv√°veis, eventos programados como o <a href="https://www.binance.com/pt-BR/events/bitcoin-halving"><strong>Halving</strong></a> ‚Äì que reduz pela metade a emiss√£o de novas moedas a cada quatro anos, simulando a escassez de metais preciosos ‚Äì continuam a impactar significativamente sua oferta e, historicamente, seu pre√ßo.</p>
<p>Mas como saber o momento certo de comprar ou vender? A resposta n√£o √© simples. O pre√ßo do Bitcoin √© influenciado por uma mir√≠ade de fatores: dados <strong>on-chain</strong> (movimenta√ß√µes na pr√≥pria blockchain), o cen√°rio <strong>macroecon√¥mico</strong> global (infla√ß√£o, taxas de juros), o <strong>sentimento do mercado</strong> e a <strong>an√°lise t√©cnica</strong> tradicional (padr√µes gr√°ficos e indicadores). Analisar isoladamente qualquer um desses aspectos oferece uma vis√£o incompleta. A verdadeira compreens√£o exige uma abordagem hol√≠stica, <strong>combinando diferentes perspectivas</strong>.</p>
<p>Foi pensando nisso, e inspirado pelos recentes avan√ßos em modelos de linguagem grandes (<strong>LLMs</strong>) e frameworks de <strong>agentes</strong>, que surgiu a ideia: <strong>E se eu delegar essa tarefa repetitiva e complexa a uma equipe de assistentes de IA?</strong> E se a IA pudesse n√£o apenas coletar e analisar os dados, mas tamb√©m <strong>interpretar o cen√°rio</strong> e <strong>sugerir a√ß√µes</strong> alinhadas a uma estrat√©gia de investimento de longo prazo, como a acumula√ß√£o gradual de Bitcoin?</p>
<p>√â aqui que entram os Agentes de IA. Pense neles como sistemas aut√¥nomos que utilizam um <strong>LLM</strong> (como os modelos GPT da OpenAI) como seu ‚Äúc√©rebro‚Äù ou motor de racioc√≠nio. Eles podem interagir com <strong>ferramentas</strong>, processar informa√ß√µes e <strong>tomar decis√µes</strong> para atingir um <strong>objetivo espec√≠fico</strong>. Em nosso caso, o objetivo ser√° fornecer uma an√°lise de mercado inteligente e automatizada, transformando dados brutos em insights acion√°veis de alto n√≠vel.</p>
</div>
<div id="arquitetura-da-solu√ß√£o-uma-equipe-de-agentes-de-ia-generativa" class="section level2">
<h2>Arquitetura da Solu√ß√£o: Uma Equipe de Agentes de IA Generativa</h2>
<p>Em vez de um √∫nico agente monol√≠tico tentando fazer tudo, o trabalho foi dividido em etapas l√≥gicas, cada uma atribu√≠da a um agente com um papel bem definido. Essa abordagem modular n√£o s√≥ organiza melhor o processo, mas tamb√©m facilita a manuten√ß√£o e a evolu√ß√£o de cada componente:</p>
<ul>
<li><strong>Data Fetcher</strong>: Coleta dados brutos de diversas APIs (cota√ß√µes, on-chain, macro, t√©cnicos).</li>
<li><strong>Data Analyst</strong>: Interpreta os dados brutos e gera um relat√≥rio t√©cnico formatado.</li>
<li><strong>Market Strategist</strong>: Sintetiza a an√°lise t√©cnica, identifica tend√™ncias e gera recomenda√ß√µes t√°ticas.</li>
<li><strong>Client Manager</strong>: Avalia a estrat√©gia sob a √≥tica do objetivo do ‚Äúcliente‚Äù (acumula√ß√£o de longo prazo) e decide se um alerta √© necess√°rio.</li>
</ul>
<p>Esses agentes utilizam <code>tools</code> (fun√ß√µes Python) para acessar APIs como <a href="https://www.blockchain.com/explorer/api">Blockchain.com</a>, <a href="https://pypi.org/project/yfinance/">Yahoo Finance</a>, <a href="https://www.coingecko.com/en/api/documentation">CoinGecko</a>, <a href="https://fred.stlouisfed.org/">FRED</a>, etc. A orquestra√ß√£o √© feita com o <strong><a href="https://github.com/features/actions">GitHub Actions</a></strong> que aciona a execu√ß√£o de todo o fluxo de trabalho todo dia - a cada 4 horas - executando o projeto que foi todo escrito em <strong>Python</strong>, <strong>LangChain</strong> (para os blocos de constru√ß√£o dos agentes), <strong>LangGraph</strong> (para o fluxo de trabalho), usando <strong>GPT-4o-mini</strong> como motor de racioc√≠nio, <strong><a href="https://telegram.me/BotFather">Telegram</a></strong> como um canal para envio de alertas e <strong>LangSmith</strong> para monitoramento e depura√ß√£o de cada passo da execu√ß√£o dos agentes.</p>
<p style="text-align: left; font-style: italic;">
üìå Clique <a href="https://gomesfellipe.github.io/post/2020-03-25-investment-alert/investment-alert/">aqui</a> para ler meu post sobre como criar bots no Telegram.
</p>
<center>
<div style="width: 90%;">
<p><img src="/post/2025-05-04-bitcoin-agent/full_workflow.png" alt="prompt chaining workflow" style="width: 100%;"></p>
</div>
<p style="text-align: center; font-style: italic;">
Fluxo de trabalho completo
</p>
</center>
</div>
<div id="construindo-o-workflow-com-langgraph" class="section level2">
<h2>Construindo o Workflow com LangGraph</h2>
<p>Para orquestrar a intera√ß√£o entre os agentes de forma robusta, foi utilizado o <strong>LangGraph</strong>, uma biblioteca sobre o LangChain para criar aplica√ß√µes LLM <em>stateful</em> e com <em>m√∫ltiplos atores</em>. Ele permite definir fluxos de trabalho como grafos, controlando explicitamente a sequ√™ncia e permitindo futuras ramifica√ß√µes ou ciclos.</p>
<div class="w3-panel w3-pale-blue w3-border">
<p>¬† üìå Os conceitos b√°sicos s√£o:</p>
<ul>
<li><strong>N√≥s (Nodes)</strong>: As unidades de trabalho (nossos agentes).</li>
<li><strong>Arestas (Edges)</strong>: As conex√µes que definem o fluxo de dados e controle entre os n√≥s.</li>
</ul>
</div>
<p>Montar o grafo envolve definir o estado compartilhado, adicionar os n√≥s e conectar as arestas. LangGraph oferece diferentes maneiras de definir essa estrutura. Abaixo, tem um exemplo conceitual usando tanto a a <strong>GraphAPI</strong>, que √© bastante expl√≠cita, quanto a <strong>Functional API</strong>, que √© mais direta ao ponto:</p>
<!-- Tabs HTML Structure -->
<div class="tabs">
<p><button class="tablink" onclick="openCode(event, 'GraphAPI')" id="defaultOpen">Graph API (Conceitual)</button>
<button class="tablink" onclick="openCode(event, 'FunctionalAPI')">Functional API (Conceitual)</button></p>
</div>
<div id="GraphAPI" class="tabcontent">
<pre class="python"><code>from langgraph.graph import StateGraph, START, END
from typing_extensions import TypedDict

# Definir o Estado do Grafo
class State(TypedDict):
    topic: str # Input do Data Fetcher
    raw_data: str # Sa√≠da do Data Fetcher
    analysis_report: str # Sa√≠da do Data Analyst
    strategy_synthesis: str # Sa√≠da do Market Strategist
    manager_decision: str # Sa√≠da do Client Manager

# Definir os N√≥s (Agentes/Fun√ß√µes)
# Supondo que as fun√ß√µes j√° foram definidas
def data_fetcher(state: State):
    # ... 
    return {&quot;raw_data&quot;: &quot;dados coletados...&quot;}

def data_analyst(state: State): ...
def market_strategist(state: State): ...
def client_manager(state: State): ...
def send_telegram_message(message_body): ...

# Construir o Grafo
workflow = StateGraph(State)

# Adicionar os n√≥s
workflow.add_node(&quot;fetcher&quot;, data_fetcher)
workflow.add_node(&quot;analyst&quot;, data_analyst)
workflow.add_node(&quot;strategist&quot;, market_strategist)
workflow.add_node(&quot;manager&quot;, client_manager)

# Definir Arestas (o fluxo sequencial)
workflow.add_edge(START, &quot;fetcher&quot;)
workflow.add_edge(&quot;fetcher&quot;, &quot;analyst&quot;)
workflow.add_edge(&quot;analyst&quot;, &quot;strategist&quot;)
workflow.add_conditional_edges(&quot;strategist&quot;, manager_decision, {
  &quot;ALERTAR_CLIENTE&quot;: &quot;send_telegram_message&quot;,
  &quot;NAO_ALERTAR&quot;: END
  })

# Compilar o grafo em um objeto execut√°vel
chain = workflow.compile()

# Executar (exemplo)
state = chain.invoke({&quot;topic&quot;: &quot;btc&quot;})</code></pre>
</div>
<div id="FunctionalAPI" class="tabcontent">
<pre class="python"><code>from langgraph.func import entrypoint, task

# Tasks/Agents

@task
def data_fetcher(topic: str) -&gt; dict: ...
  
@task 
def data_analyst(state: State): ...

@task
def market_strategist(state: State): ...

@task
def client_manager(state: State): ...

def plot_btc_analysis(): ...
def send_telegram_photo(fig): ...
def send_telegram_message(message_body): ...

# Exemplo conceitual com abordagem funcional (usando decoradores)
@entrypoint()
def chaining_workflow(topic: str):
    data_fetched = data_fetcher(topic).result()
    analyst_report = data_analyst(data_fetched).result()
    strategist_report = market_strategist(analyst_report).result()
    
    if &#39;ALERTAR&#39; in client_manager(strategist_report).result():
        fig = plot_btc_analysis()
        asyncio.run(send_telegram_photo(fig))
        asyncio.run(send_telegram_message(strategist_report))
        return &quot;Entrar em contato&quot;
    return &quot;N√£o entrar em contato&quot;

def run_chaining_workflow(topic: str, stream_mode: str = &quot;updates&quot;):
    return chaining_workflow.stream(topic, stream_mode=stream_mode)

# Invoke
logger.info(&quot;Iniciando o workflow...\n&quot;)
for step in run_chaining_workflow(&quot;&quot;, stream_mode=&quot;updates&quot;):
    for key, value in step.items():
        logger.info(f&quot;[ {key} ]\n{&#39;=&#39; * 80}\n{value}\n&quot;)
logger.info(&quot;Workflow finalizado.&quot;)
        </code></pre>
</div>
<!-- Script para funcionalidade das abas -->
<script>
function openCode(evt, codeName) {
  var i, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tablink");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }
  document.getElementById(codeName).style.display = "block";
  evt.currentTarget.className += " active";
}
// Abre a primeira aba por padr√£o
document.getElementById("defaultOpen").click();
</script>
<!-- Estilos b√°sicos para as abas (adicione ao CSS do seu blog) -->
<style>
.tabs { overflow: hidden; border-bottom: 1px solid #ccc; margin-bottom: 10px; }
.tablink { background-color: #f1f1f1; float: left; border: none; outline: none; cursor: pointer; padding: 8px 16px; font-size: 1rem; transition: 0.3s; }
.tablink:hover { background-color: #ddd; }
.tablink.active { background-color: #ccc; }
.tabcontent { display: none; padding: 6px 0px; border-top: none; animation: fadeEffect 1s; }
@keyframes fadeEffect { from {opacity: 0;} to {opacity: 1;} }
</style>
<p>Este controle fino do fluxo, seja pela API expl√≠cita ou por abordagens mais funcionais, √© uma das grandes vantagens do LangGraph para sistemas multi-agentes, que ainda permite uma integra√ß√£o com o LangSmith para acompanhamento detalhado do fluxo de ‚Äúracioc√≠nio‚Äù dos agentes. Para mais detalhes, consulte a <a href="https://langchain-ai.github.io/langgraph/">documenta√ß√£o oficial</a>.</p>
</div>
<div id="mergulhando-nos-agentes-prompts-e-ferramentas" class="section level2">
<h2>Mergulhando nos Agentes: Prompts e Ferramentas</h2>
<p>Vamos ver rapidamente como cada agente funciona, focando nos prompts e ferramentas:</p>
<div id="agente-1-data-fetcher-o-pesquisador" class="section level3">
<h3>Agente 1: Data Fetcher (O Pesquisador)</h3>
<center>
<div style="width: 90%;">
<p><img src="/post/2025-05-04-bitcoin-agent/01.png" alt="data fetcher agent" style="width: 100%;"></p>
</div>
<p style="text-align: center; font-style: italic;">
Fluxo de trabalho do Data Researcher
</p>
</center>
<details>
<summary>
<em>Ver c√≥digo</em>
</summary>
<pre class="python"><code>from pydantic import BaseModel, Field
from langchain.schema.messages import HumanMessage, ToolMessage
from langgraph.func import task
from langchain_openai import ChatOpenAI

from tools.fetch_data_btc import fetch_data_btc
from tools.fetch_data_onchain import fetch_data_onchain
from tools.fetch_data_macroeconomic import fetch_data_macroeconomic
from tools.fetch_data_market import fetch_data_market
from tools.fetch_data_tecnical import fetch_data_tecnical

llm = ChatOpenAI(model=&quot;gpt-4o-mini&quot;, temperature=0)

@task
def data_fetcher(topic: str):
  
  class StructuredJsonOutput(BaseModel):
    btc_data: str = Field(None, description=&quot;Bitcoin data and USD to BRL exchange rate&quot;)
    onchain_data: str = Field(None, description=&quot;On-chain Bitcoin data&quot;)
    macroeconomic_data: str = Field(None, description=&quot;Macroeconomic data&quot;)
    market_data: str = Field(None, description=&quot;Market sentiment and Bitcoin-related metrics&quot;)
    tecnical_data: str = Field(None, description=&quot;technical analysis indicators for Bitcoin&quot;)

  structured_llm = llm.with_structured_output(StructuredJsonOutput)

  instructions = &quot;Voc√™ √© um pesquisador respons√°vel por coletar dados de diferentes fontes sobre o mercado de Bitcoin e gerar um output no formato json.&quot;

  tools = [
      fetch_data_btc,
      fetch_data_onchain,
      fetch_data_macroeconomic,
      fetch_data_market,
      fetch_data_tecnical
      ]

  tools_by_name = {tool.name: tool for tool in tools}

  llm_with_tools = llm.bind_tools(tools)

  messages = [HumanMessage(instructions)]
  ai_msg = llm_with_tools.invoke(messages)
  messages.append(ai_msg)

  for tool_call in ai_msg.tool_calls:
      selected_tool = tools_by_name[tool_call[&quot;name&quot;].lower()]
      tool_output = selected_tool.invoke(tool_call[&quot;args&quot;])
      messages.append(ToolMessage(tool_output, tool_call_id=tool_call[&quot;id&quot;]))

  messages.append(structured_llm.invoke(messages))

  return messages[-1].model_dump_json(indent=3)</code></pre>
</details>
<ul>
<li><strong>Objetivo</strong>: Coletar dados brutos e atualizados de diversas fontes sobre o Bitcoin, abrangendo cota√ß√µes, indicadores on-chain, dados macroecon√¥micos e t√©cnicos.</li>
<li><strong>Funcionamento</strong>: Este agente n√£o calcula nem interpreta, ele apenas orquestra a chamada de v√°rias <code>tools</code> (fun√ß√µes Python que interagem com APIs externas). Essa fun√ß√£o do LangChain permite que o LLM, ao receber a instru√ß√£o inicial (‚Äúcolete os dados sobre o mercado de Bitcoin‚Äù), analise as ferramentas dispon√≠veis e decida quais delas chamar e com quais argumentos. Ap√≥s as ferramentas retornarem seus resultados, usamos <code>llm.with_structured_output(StructuredJsonOutput)</code> para instruir o LLM a consolidar todas as informa√ß√µes coletadas em um √∫nico objeto <strong>JSON estruturado</strong>. Isso garante que a sa√≠da do Data Fetcher seja consistente e f√°cil de processar pelo pr√≥ximo agente.</li>
</ul>
</div>
<div id="agente-2-data-analyst-o-int√©rprete" class="section level3">
<h3>Agente 2: Data Analyst (O Int√©rprete)</h3>
<center>
<div style="width: 90%;">
<p><img src="/post/2025-05-04-bitcoin-agent/02.png" alt="data analyst agent" style="width: 100%;"></p>
</div>
<p style="text-align: center; font-style: italic;">
Fluxo de trabalho do Data Analyst
</p>
</center>
<details>
<summary>
<em>Ver c√≥digo</em>
</summary>
<pre class="python"><code>from langgraph.func import task
from langchain.prompts import ChatPromptTemplate, FewShotChatMessagePromptTemplate
from langchain_openai import ChatOpenAI

from prompts.data_analyst_example import input_example, output_example

llm = ChatOpenAI(model=&quot;gpt-4&quot;, temperature=0.7)

@task
def data_analyst(report: str):

  input = f&quot;&quot;&quot;
  Voc√™ √© um analista financeiro experiente em Cryptomoedas e especialista em Bitcoin.
  Analise as tend√™ncias do cen√°rio do Bitcoin hoje com base no json \
  delimitado por tr√™s crases (```):

  \```
  {report}
  \```

  Siga rigorosamente as instru√ß√µes abaixo:

  - ...
  &quot;&quot;&quot;

  examples = [
      {&quot;input&quot;: input_example, &quot;output&quot;: output_example},
       ]

  example_prompt = ChatPromptTemplate.from_messages([
      (&quot;human&quot;, &quot;{input}&quot;),
      (&quot;ai&quot;, &quot;{output}&quot;),
      ])

  few_shot_prompt = FewShotChatMessagePromptTemplate(
      example_prompt=example_prompt,
      examples=examples,
      )

  prompt_system = &quot;Voc√™ √© um analista financeiro experiente em Criptomoedas e especialista em Bitcoin.&quot;

  final_prompt = ChatPromptTemplate.from_messages([
    (&quot;system&quot;, prompt_system),
    few_shot_prompt,
    (&quot;human&quot;, &quot;{input}&quot;),
    ])

  chain = final_prompt | llm

  msg = chain.invoke(input=input)

  return msg.content</code></pre>
</details>
<ul>
<li><strong>Objetivo</strong>: Receber o JSON de dados brutos do Data Fetcher e transform√°-lo em um relat√≥rio anal√≠tico coeso, formatado em Markdown, interpretando cada indicador e explicando seu poss√≠vel impacto.</li>
<li><strong>Prompt Engineering em A√ß√£o</strong>: Este agente √© um √≥timo exemplo de como guiar um LLM para tarefas complexas de formata√ß√£o e interpreta√ß√£o.
<ul>
<li><strong>Instru√ß√µes Detalhadas</strong>: O prompt define explicitamente o papel do agente (‚Äúanalista financeiro experiente‚Äù), o formato desejado (Markdown, bullet points, negrito), o tom (‚Äúequilibrado e menos t√©cnico‚Äù), e regras espec√≠ficas (mencionar pre√ßos em USD e BRL, usar sinal de menos para varia√ß√µes negativas, seguir a estrutura do exemplo).</li>
<li><strong>Estrat√©gia Few-Shot</strong>: Para garantir que o LLM siga o formato e o estilo de interpreta√ß√£o desejados, utilizamos a t√©cnica Few-Shot (semelhante como fiz em um <a href="https://gomesfellipe.github.io/post/2024-05-26-detec-o-de-linguagem-t-xica-com-o-llm-gemma-e-langchain/">post anterior</a>). Fornecemos um exemplo completo de um input (um JSON de dados similar ao que o Data Fetcher produziria) e o output correspondente (o relat√≥rio em Markdown formatado e interpretado). Isso √© feito usando <code>FewShotChatMessagePromptTemplate</code> do LangChain, que insere o exemplo diretamente no contexto do prompt final.</li>
<li><strong>Cadeia LCEL</strong>: O prompt final √© constru√≠do usando a LangChain Expression Language (LCEL), combinando o prompt do sistema (definindo o papel), o prompt Few-Shot (com o exemplo) e o prompt humano (contendo as instru√ß√µes e o JSON de dados brutos atual).</li>
</ul></li>
</ul>
</div>
<div id="agente-3-market-strategist-o-conselheiro" class="section level3">
<h3>Agente 3: Market Strategist (O Conselheiro)</h3>
<center>
<div style="width: 80%;">
<p><img src="/post/2025-05-04-bitcoin-agent/03.png" alt="market strategist agent" style="width: 100%;"></p>
</div>
<p style="text-align: center; font-style: italic;">
Fluxo de trabalho do Market Strategist
</p>
</center>
<details>
<summary>
<em>Ver c√≥digo</em>
</summary>
<pre class="python"><code>from langgraph.func import task
from langchain.prompts import ChatPromptTemplate
from langchain_openai import ChatOpenAI

llm = ChatOpenAI(temperature=0.7)

@task
def market_strategist(analyst_report: str):
    &quot;&quot;&quot;
    Gera recomenda√ß√µes de posicionamento com base na an√°lise do Data Analyst.
    &quot;&quot;&quot;
  
    input = f&quot;&quot;&quot;
    Seu papel √© analisar o relat√≥rio t√©cnico fornecido no formatado em Markdown e transformar\
    em uma s√≠ntese estrat√©gica e executiva, com alertas, insights e orienta√ß√µes t√°ticas de alto n√≠vel.
  
    \``` markdown
    {analyst_report}
    \```
  
    Siga rigorosamente as instru√ß√µes abaixo:
  
    - ...
    &quot;&quot;&quot;
  
    prompt = ChatPromptTemplate.from_messages([
        (&quot;system&quot;, &quot;Voc√™ √© um estrategista de mercado s√™nior, com ampla experi√™ncia em ativos digitais e especializa√ß√£o em Bitcoin.&quot;),
        (&quot;human&quot;, &quot;{input}&quot;)
    ])
  
    chain = prompt | llm
    msg = chain.invoke(input=input)
    return msg.content
</code></pre>
</details>
<ul>
<li><strong>Objetivo</strong>: Ler o relat√≥rio t√©cnico detalhado do Data Analyst e interpretar as informa√ß√µes em uma s√≠ntese estrat√©gica e executiva. O foco √© identificar a tend√™ncia geral, destacar sinais chave e fornecer recomenda√ß√µes t√°ticas claras.</li>
<li><strong>Prompt</strong>: O prompt para este agente √© crucial para mudar o n√≠vel da an√°lise. Ele instrui o LLM a agir como um ‚Äúestrategista de mercado s√™nior‚Äù, focando em:
<ul>
<li><strong>Resumo</strong>: Extrair os pontos mais cr√≠ticos.</li>
<li><strong>Tend√™ncia</strong>: Classificar o mercado (alta, baixa, neutro).</li>
<li><strong>Sinais</strong>: Identificar indicadores de otimismo ou cautela.</li>
<li><strong>Recomenda√ß√µes</strong>: Gerar orienta√ß√µes pr√°ticas e acion√°veis (‚Äúisso indica que‚Ä¶‚Äù, ‚Äúlogo, √© prudente‚Ä¶‚Äù).</li>
<li><strong>Racioc√≠nio</strong>: Explicitar o processo de pensamento com <strong>CoT</strong> (<strong>Chain-of-Thought</strong>) que levou √†s conclus√µes antes de apresentar a s√≠ntese final.</li>
<li><strong>Tom</strong>: Consultivo, direto e profissional.</li>
</ul></li>
</ul>
</div>
<div id="agente-4-client-manager-o-porteiro" class="section level3">
<h3>Agente 4: Client Manager (O Porteiro)</h3>
<center>
<div style="width: 80%;">
<p><img src="/post/2025-05-04-bitcoin-agent/04.png" alt="client manager agent" style="width: 100%;"></p>
</div>
<p style="text-align: center; font-style: italic;">
Fluxo de trabalho do Client Manager
</p>
</center>
<details>
<summary>
<em>Ver c√≥digo</em>
</summary>
<pre class="python"><code>from langgraph.func import task
from langchain.prompts import ChatPromptTemplate
from langchain_openai import ChatOpenAI

llm = ChatOpenAI(temperature=0.7)

@task
def client_manager(final_report: str):
    &quot;&quot;&quot;
    Avalia o relat√≥rio estrat√©gico e decide se deve ou n√£o alertar o cliente.
    A decis√£o final √© bin√°ria: ALERTAR_CLIENTE ou N√ÉO_ALERTAR.
    &quot;&quot;&quot;

    input = f&quot;&quot;&quot;
    Objetivo do cliente: Acumular Bitcoins no longo prazo, investindo mensalmente nas melhores janelas de oportunidade.

    Seu papel √© avaliar o relat√≥rio abaixo e decidir se h√° motivos suficientes para alertar o cliente:

    \``` markdown
    {final_report}
    \```

    Siga rigorosamente as instru√ß√µes abaixo:

    - ...
    &quot;&quot;&quot;

    prompt = ChatPromptTemplate.from_messages([
        (&quot;system&quot;, &quot;Voc√™ √© um Client Manager, especializado em comunica√ß√£o estrat√©gica com clientes de alto valor.&quot;),
        (&quot;human&quot;, &quot;{input}&quot;)
    ])

    chain = prompt | llm
    msg = chain.invoke(input=input)
    return msg.content
</code></pre>
</details>
<ul>
<li><strong>Objetivo</strong>: Avaliar a s√≠ntese estrat√©gica do Market Strategist √† luz do objetivo espec√≠fico do cliente (acumula√ß√£o de longo prazo) e tomar uma decis√£o bin√°ria: a situa√ß√£o atual justifica um alerta ou n√£o?</li>
<li><strong>Prompt</strong>: Este prompt √© focado na tomada de decis√£o.
<ul>
<li><strong>Contexto do Cliente</strong>: Define claramente o objetivo (‚ÄúAcumular Bitcoins no longo prazo, investindo mensalmente nas melhores janelas de oportunidade.‚Äù).</li>
<li><strong>Crit√©rios de Alerta</strong>: Especifica o que procurar (mudan√ßa relevante de tend√™ncia, risco/oportunidade claros, indicadores extremos, recomenda√ß√µes urgentes).</li>
<li><strong>Racioc√≠nio Obrigat√≥rio</strong>: Exige que o agente explique seu processo de pensamento <strong>CoT</strong> (<strong>Chain-of-Thought</strong>) antes da decis√£o final.</li>
<li><strong>Output Bin√°rio</strong>: A resposta final deve ser <em>apenas</em> a palavra <code>ALERTAR</code> ou <code>N√ÉO_ALERTAR</code> em mai√∫sculas, precedida pelo racioc√≠nio.</li>
</ul></li>
</ul>
</div>
</div>
<div id="desafios-aprendizados-e-observabilidade" class="section level2">
<h2>Desafios, Aprendizados e Observabilidade</h2>
<p>Construir agentes envolve desafios:</p>
<ul>
<li><strong>Prompt Engineering</strong>: √â uma arte iterativa. Clareza, exemplos (Few-Shot) e estrutura s√£o essenciais.</li>
<li><strong>Orquestra√ß√£o (LangGraph)</strong>: Gerenciar o estado e o fluxo entre n√≥s exige aten√ß√£o.</li>
<li><strong>Integra√ß√£o de Ferramentas</strong>: Descri√ß√µes claras das <code>tools</code> s√£o vitais para o LLM us√°-las corretamente.</li>
<li><strong>Observabilidade</strong>: Identificar falhas em fluxos complexos pode ser dif√≠cil.</li>
</ul>
<p>Ferramentas como o <strong>LangSmith</strong> s√£o extremamente √∫teis na monitoramento dos agentes, permitindo rastrear e depurar cada passo de sua execu√ß√£o, chamadas de LLM e uso de ferramentas. Ele oferece uma vis√£o clara do que est√° acontecendo ‚Äúpor baixo dos panos‚Äù, facilitando a identifica√ß√£o de gargalos ou erros.</p>
<center>
<div style="width: 90%;">
<p><img src="/post/2025-05-04-bitcoin-agent/langsmith-exemplo.png" alt="langsmith" style="width: 100%;"></p>
</div>
<p style="text-align: center; font-style: italic;">
Print da tela do LangSmith do projeto
</p>
</center>
</div>
<div id="conclus√£o" class="section level2">
<h2>Conclus√£o</h2>
<p>Criamos uma equipe de agentes IA capaz de automatizar a complexa an√°lise do mercado Bitcoin, usando LangChain e LangGraph para orquestra√ß√£o. O sistema coleta dados, interpreta, gera estrat√©gias e decide sobre alertas, transformando dados brutos em insights acion√°veis. Veja como √© o alerta recebido no Telegram:</p>
<div style="display: flex; justify-content: space-between; align-items: center;">
<center>
<p><img src="/post/2025-05-04-bitcoin-agent/telegram1.PNG" alt="Report no Telegram 1" style="width: 80%;"></p>
</center>
<center>
<p><img src="/post/2025-05-04-bitcoin-agent/telegram2.PNG" alt="Report no Telegram 2" style="width: 80%;"></p>
</center>
</div>
<p style="text-align: center; font-style: italic;">
Print das telas do bot no Telegram.
</p>
<p>Este projeto demonstra o potencial dos agentes para automatizar tarefas repetitivas que envolvem a tomada de decis√µes com um certo ‚Äúracioc√≠nio‚Äù. Os pr√≥ximos passos podem envolver refinar prompts, adicionar mais ferramentas, integrar mais visualiza√ß√µes ou implementar notifica√ß√µes ativas.</p>
</div>
<div id="refer√™ncias" class="section level2">
<h2>Refer√™ncias</h2>
<ul>
<li><a href="https://python.langchain.com/">LangChain - Documenta√ß√£o</a></li>
<li><a href="https://langchain-ai.github.io/langgraph/">LangGraph - Documenta√ß√£o</a></li>
<li><a href="https://smith.langchain.com/">LangSmith - Documenta√ß√£o</a></li>
<li><a href="https://openai.com/api/">OpenAI API Plataform</a></li>
<li><a href="https://github.com/openai/openai-cookbook/blob/main/examples/gpt4-1_prompting_guide.ipynb">OpenAI - Prompt Engineering Guide</a></li>
<li><a href="https://cdn.openai.com/business-guides-and-resources/a-practical-guide-to-building-agents.pdf">OpenAI - A Practical Guide to Building Agents</a></li>
<li><a href="https://langchain-ai.github.io/langgraph/tutorials/workflows/">LangGraph Tutorial - Building Agentic Workflows</a></li>
<li><a href="https://blog.langchain.dev/how-to-think-about-agent-frameworks/">LangChain Blog - How to think about agent frameworks</a></li>
</ul>
</div>

        <p><strong>Leia o post completo em:</strong> <a href="https://gomesfellipe.github.io/post/2025-05-04-bitcoin-agent/">Construindo uma Equipe Multiagente de IA para An√°lise do Mercado Bitcoin</a></p>
        <p><em>Este post foi originalmente publicado em <a href="https://gomesfellipe.github.io/">Fellipe Gomes - Data Science Blog</a></em></p>
      ]]></content:encoded>
      <category>Fundamentos de Data Science</category>
      <category>Intelig√™ncia Artificial</category>
      <category>Programa√ß√£o e Ferramentas</category>
      <category domain="tag">agent-ai</category>
      <category domain="tag">analise-dados</category>
      <category domain="tag">bitcoin</category>
      <category domain="tag">crypto</category>
      <category domain="tag">inteligencia-artificial</category>
      <category domain="tag">langchain</category>
      <category domain="tag">langgraph</category>
      <category domain="tag">langsmith</category>
      <category domain="tag">llm</category>
      <category domain="tag">mercado-financeiro</category>
    </item>
  </channel>
</rss>